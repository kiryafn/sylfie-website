<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
  <meta charset="UTF-8">
  <title layout:fragment="title">Создать новый тур</title>
  <script src="https://cdn.tailwindcss.com"></script>


  <!-- Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- CKEditor 5 Classic -->
  <script src="https://cdn.ckeditor.com/ckeditor5/38.1.1/classic/ckeditor.js"></script>
</head>
<body class="bg-gray-50 text-gray-800 font-poppins">
<main layout:fragment="content" class="max-w-6xl mx-auto p-6">

  <h1 class="text-3xl font-semibold mb-6">Создать новый тур</h1>

  <form th:action="@{/tours/save}" th:object="${template}" method="post" enctype="multipart/form-data" class="bg-white shadow rounded-lg p-6 space-y-8">

    <!-- Основная информация -->
    <section>
      <h2 class="text-xl font-semibold mb-4">Основная информация</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="name" class="block font-medium mb-1">Название тура</label>
          <input type="text" id="name" th:field="*{name}" required class="w-full border rounded px-3 py-2">
        </div>

        <div>
          <label for="shortDescription" class="block font-medium mb-1">Краткое описание</label>
          <textarea id="shortDescription" th:field="*{shortDescription}" rows="2" class="w-full border rounded px-3 py-2"></textarea>
        </div>

        <div>
          <label class="block font-medium mb-1">Сложность</label>
          <div class="flex gap-4">
            <label class="flex items-center gap-2">
              <input type="radio" th:field="*{difficulty}" value="EASY"> Лёгкая
            </label>
            <label class="flex items-center gap-2">
              <input type="radio" th:field="*{difficulty}" value="MEDIUM"> Средняя
            </label>
            <label class="flex items-center gap-2">
              <input type="radio" th:field="*{difficulty}" value="HARD"> Сложная
            </label>
          </div>
        </div>

        <div>
          <label for="durationDays" class="block font-medium mb-1">Длительность (дней)</label>
          <input type="number" id="durationDays" th:field="*{durationDays}" min="1" required class="w-full border rounded px-3 py-2">
        </div>

        <div>
          <label for="price" class="block font-medium mb-1">Цена (USD)</label>
          <input type="number" id="price" th:field="*{price}" step="0.01" required class="w-full border rounded px-3 py-2">
        </div>

        <div>
          <label for="maxParticipants" class="block font-medium mb-1">Макс. участников</label>
          <input type="number" id="maxParticipants" th:field="*{maxParticipants}" min="1" required class="w-full border rounded px-3 py-2">
        </div>

        <div>
          <label for="category" class="block font-medium mb-1">Категория</label>
          <select id="category" th:field="*{category}" required class="w-full border rounded px-3 py-2">
            <option value="" disabled selected>Выберите категорию</option>
            <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.name}">Категория</option>
          </select>
        </div>

        <div>
          <label for="location" class="block font-medium mb-1">Локация</label>
          <select id="location" th:field="*{location}" required class="w-full border rounded px-3 py-2">
            <option value="" disabled selected>Выберите локацию</option>
            <option th:each="loc : ${locations}" th:value="${loc.id}" th:text="${loc.name}">Локация</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Полное описание -->
    <section>
      <h2 class="text-xl font-semibold mb-4">Полный текст (HTML)</h2>
      <div>
        <label for="descriptionHtml" class="block font-medium mb-1">Описание тура</label>
        <textarea id="descriptionHtml" th:field="*{descriptionHtml}" rows="8" class="w-full border rounded px-3 py-2"></textarea>
      </div>
    </section>

    <!-- Превью-картинка -->
    <section>
      <h2 class="text-xl font-semibold mb-4">Превью-картинка</h2>
      <div>
        <label for="previewPic" class="block font-medium mb-1">Выберите превью</label>
        <input type="file" id="previewPic" name="previewPic" accept="image/*" class="block w-full">
        <div id="previewThumb" class="mt-4"></div>
      </div>
    </section>

    <!-- Галерея -->
    <section>
      <h2 class="text-xl font-semibold mb-4">Галерея (несколько фото)</h2>
      <div>
        <label for="pictures" class="block font-medium mb-1">Загрузить изображения</label>
        <input type="file" id="pictures" name="pictures" multiple accept="image/*" class="block w-full">
        <div id="galleryThumbs" class="flex flex-wrap gap-4 mt-4"></div>
      </div>
    </section>

    <!-- Кнопки -->
    <div class="flex justify-start gap-4">
      <button type="submit" class="bg-green-600 text-white px-5 py-2 rounded hover:bg-green-700">
        <i class="fas fa-save mr-2"></i>Создать тур
      </button>
      <a href="#" onclick="history.back()" class="bg-gray-300 text-gray-800 px-5 py-2 rounded hover:bg-gray-400">
        <i class="fas fa-times mr-2"></i>Отмена
      </a>
    </div>
  </form>

  <script>
    ClassicEditor
            .create(document.querySelector('#descriptionHtml'), {
              toolbar: ['heading', '|', 'bold', 'italic', 'underline', '|', 'bulletedList', 'numberedList', '|', 'link', 'imageUpload', '|', 'undo', 'redo'],
              image: { toolbar: ['imageTextAlternative', '|', 'imageStyle:full', 'imageStyle:side'] }
            })
            .catch(error => console.error(error));
  </script>
</main>
</body>
</html>